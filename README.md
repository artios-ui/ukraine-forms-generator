# Informatics AI — тести для школи в Google Sheets

Це простий застосунок на **Google Sheets + Apps Script**, який допомагає вчителю швидко:
- створювати **тести Google Forms** за класом і темою;
- збирати результати в один аркуш `Results`;
- автоматично робити **адаптивні тренувальні тести** для учнів (за їхніми слабкими темами);
- (за бажанням) надсилати учням посилання на тести через Gmail.

Застосунок **безкоштовний** (це скрипт у вашому Google Sheets).  
Але для генерації питань потрібен **API ключ** сервісу **OpenRouter** — його треба отримати **самостійно**.

---

## Важливо: потрібен свій API ключ OpenRouter
Цей проєкт НЕ дає ключ автоматично. Вам потрібно:
1) зайти на https://openrouter.ai/  
2) створити акаунт  
3) отримати **API Key**  
4) вставити його в налаштування (див. нижче)

Без ключа генерація питань не працюватиме.

---

## Що саме робить скрипт
### 1) Створює тести Google Forms
Ви вводите:
- клас (наприклад, 9 клас)
- тему (наприклад, Цикли в Python)
- кількість питань

Скрипт створює Google Form і показує два посилання:
- для вчителя (редагування)
- для учнів (проходження)

### 2) Збирає результати в `Results`
Можна:
- імпортувати `CSV` з Drive в аркуш `Results`
- або експортувати результати з активного аркуша відповідей Google Form у `Results`

### 3) Робить адаптивні тести
Скрипт дивиться, по яких темах у учня низький відсоток, і створює персональний тренувальний тест.

---

## Що потрібно для роботи
- Google аккаунт
- Google Sheets
- Google Forms
- (за бажанням) Gmail для розсилки
- API ключ з OpenRouter: https://openrouter.ai/

---

## Як встановити (1 раз)
1) Створіть Google Sheet.
2) Відкрийте: **Розширення → Apps Script** (Extensions → Apps Script).
3) Вставте код у файл (наприклад `Code.gs`) і збережіть.
4) Перезавантажте Google Sheet.
5) При першому запуску дайте дозволи (Sheets/Forms/Drive, і Gmail — якщо потрібна розсилка).

Після цього в меню з’явиться пункт **Інформатика AI**.

---

## Як додати API ключ (обов’язково)
Є 2 способи. Рекомендований — Script Properties.

### Спосіб 1 (рекомендовано): Script Properties
1) Apps Script → **Project Settings**
2) **Script Properties** → Add script property
3) Додайте:
- Key: `OPENROUTER_API_KEYS`
- Value: `ваш_ключ`

Якщо у вас кілька ключів:
- Value: `key1,key2,key3` (через кому)

### Спосіб 2: аркуш `Settings`
Створіть у таблиці аркуш **Settings**:
- колонка A: `key`
- колонка B: `value`

Додайте рядок:
- `OPENROUTER_API_KEYS` | `ваш_ключ`

---

## Основні аркуші
### `Results`
Тут зберігаються результати учнів. Мінімально потрібно:
- `email`
- `topic`
- `score_percent` (або `score` / `percent`)
- (опційно) `name`

### `AdaptiveLinks`
Створюється автоматично. Там будуть:
- email учня
- слабкі теми
- посилання на створену форму
- поле `sent` (коли відправили лист)

---

## Як користуватись (просто)
1) Відкрийте Google Sheet.
2) Меню **Інформатика AI** → **Створити тест (клас/тема)…**
3) Дайте учням посилання на форму.
4) Після проходження:
   - меню → **Експорт результатів (Аркуш -> Results)**  
   (вкажіть тему та максимальний бал)
5) Меню → **Згенерувати адаптивні тести (всім)**  
   або **Адаптивний тест (одному)…**
6) (за бажанням) Меню → **Розіслати листи**

---

## Налаштування (необов’язково)
Можна налаштувати в `Settings` або Script Properties:
- `WEAK_TOPIC_THRESHOLD` — поріг слабкої теми (за замовчуванням 70)
- `ADAPTIVE_TOTAL_QUESTIONS` — скільки питань у адаптивному тесті (за замовчуванням 6)
- `OPENROUTER_MODELS` — список моделей через кому (якщо хочете свої)
- `SEND_EMAILS_AUTOMATICALLY` — `true/false` (автовідправка одразу після генерації)

---
